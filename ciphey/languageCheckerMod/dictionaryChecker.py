import string
import os
import sys

sys.path.append("..")
try:
    import mathsHelper as mh
except ModuleNotFoundError:
    import ciphey.mathsHelper as mh


class dictionaryChecker:
    """
    Class designed to confirm whether something is **language** based on how many words of **language** appears
    Call confirmlanguage(text, language)
    * text: the text you want to confirm
    * language: the language you want to confirm

    Find out what language it is by using chisquared.py, the highest chisquared score is the language
    languageThreshold = 45
    if a string is 45% **language** words, then it's confirmed to be english
    """

    def __init__(self):
        self.mh = mh.mathsHelper()
        self.languagePercentage = 0.0
        self.languageWordsCounter = 0.0
        self.languageThreshold = 55
        # this is hard coded because i dont want to use a library or rely on reading from files, as it's slow.
        self.top1000Words = [
            "able",
            "about",
            "above",
            "act",
            "add",
            "afraid",
            "after",
            "again",
            "against",
            "age",
            "ago",
            "agree",
            "air",
            "all",
            "allow",
            "also",
            "always",
            "am",
            "among",
            "an",
            "and",
            "anger",
            "animal",
            "answer",
            "any",
            "appear",
            "apple",
            "are",
            "area",
            "arm",
            "arrange",
            "arrive",
            "art",
            "as",
            "ask",
            "at",
            "atom",
            "baby",
            "back",
            "bad",
            "ball",
            "band",
            "bank",
            "bar",
            "base",
            "basic",
            "bat",
            "be",
            "bear",
            "beat",
            "beauty",
            "bed",
            "been",
            "before",
            "began",
            "begin",
            "behind",
            "believe",
            "bell",
            "best",
            "better",
            "between",
            "big",
            "bird",
            "bit",
            "black",
            "block",
            "blood",
            "blow",
            "blue",
            "board",
            "boat",
            "body",
            "bone",
            "book",
            "born",
            "both",
            "bottom",
            "bought",
            "box",
            "boy",
            "branch",
            "bread",
            "break",
            "bright",
            "bring",
            "broad",
            "broke",
            "brother",
            "brought",
            "brown",
            "build",
            "burn",
            "busy",
            "but",
            "buy",
            "by",
            "call",
            "came",
            "camp",
            "can",
            "capital",
            "captain",
            "car",
            "card",
            "care",
            "carry",
            "case",
            "cat",
            "catch",
            "caught",
            "cause",
            "cell",
            "cent",
            "center",
            "century",
            "certain",
            "chair",
            "chance",
            "change",
            "character",
            "charge",
            "chart",
            "check",
            "chick",
            "chief",
            "child",
            "children",
            "choose",
            "chord",
            "circle",
            "city",
            "claim",
            "class",
            "clean",
            "clear",
            "climb",
            "clock",
            "close",
            "clothe",
            "cloud",
            "coast",
            "coat",
            "cold",
            "collect",
            "colony",
            "color",
            "column",
            "come",
            "common",
            "company",
            "compare",
            "complete",
            "condition",
            "connect",
            "consider",
            "consonant",
            "contain",
            "continent",
            "continue",
            "control",
            "cook",
            "cool",
            "copy",
            "corn",
            "corner",
            "correct",
            "cost",
            "cotton",
            "could",
            "count",
            "country",
            "course",
            "cover",
            "cow",
            "crease",
            "create",
            "crop",
            "cross",
            "crowd",
            "cry",
            "current",
            "cut",
            "dad",
            "dance",
            "danger",
            "dark",
            "day",
            "dead",
            "deal",
            "dear",
            "death",
            "decide",
            "decimal",
            "deep",
            "degree",
            "depend",
            "describe",
            "desert",
            "design",
            "determine",
            "develop",
            "dictionary",
            "did",
            "die",
            "differ",
            "difficult",
            "direct",
            "discuss",
            "distant",
            "divide",
            "division",
            "do",
            "doctor",
            "does",
            "dog",
            "dollar",
            "don't",
            "done",
            "door",
            "double",
            "down",
            "draw",
            "dream",
            "dress",
            "drink",
            "drive",
            "drop",
            "dry",
            "duck",
            "during",
            "each",
            "ear",
            "early",
            "earth",
            "ease",
            "east",
            "eat",
            "edge",
            "effect",
            "egg",
            "eight",
            "either",
            "electric",
            "element",
            "else",
            "end",
            "enemy",
            "energy",
            "engine",
            "enough",
            "enter",
            "equal",
            "equate",
            "especially",
            "even",
            "evening",
            "event",
            "ever",
            "every",
            "exact",
            "example",
            "except",
            "excite",
            "exercise",
            "expect",
            "experience",
            "experiment",
            "eye",
            "face",
            "fact",
            "fair",
            "fall",
            "family",
            "famous",
            "far",
            "farm",
            "fast",
            "fat",
            "father",
            "favor",
            "fear",
            "feed",
            "feel",
            "feet",
            "fell",
            "felt",
            "few",
            "field",
            "fig",
            "fight",
            "figure",
            "fill",
            "final",
            "find",
            "fine",
            "finger",
            "finish",
            "fire",
            "first",
            "fish",
            "fit",
            "five",
            "flat",
            "floor",
            "flow",
            "flower",
            "fly",
            "follow",
            "food",
            "foot",
            "for",
            "force",
            "forest",
            "form",
            "forward",
            "found",
            "four",
            "fraction",
            "free",
            "fresh",
            "friend",
            "from",
            "front",
            "fruit",
            "full",
            "fun",
            "game",
            "garden",
            "gas",
            "gather",
            "gave",
            "general",
            "gentle",
            "get",
            "girl",
            "give",
            "glad",
            "glass",
            "go",
            "gold",
            "gone",
            "good",
            "got",
            "govern",
            "grand",
            "grass",
            "gray",
            "great",
            "green",
            "grew",
            "ground",
            "group",
            "grow",
            "guess",
            "guide",
            "gun",
            "had",
            "hair",
            "half",
            "hand",
            "happen",
            "happy",
            "hard",
            "has",
            "hat",
            "have",
            "he",
            "head",
            "hear",
            "heard",
            "heart",
            "heat",
            "heavy",
            "held",
            "help",
            "her",
            "here",
            "high",
            "hill",
            "him",
            "his",
            "history",
            "hit",
            "hold",
            "hole",
            "home",
            "hope",
            "horse",
            "hot",
            "hour",
            "house",
            "how",
            "huge",
            "human",
            "hundred",
            "hunt",
            "hurry",
            "ice",
            "idea",
            "if",
            "imagine",
            "in",
            "inch",
            "include",
            "indicate",
            "industry",
            "insect",
            "instant",
            "instrument",
            "interest",
            "invent",
            "iron",
            "is",
            "island",
            "it",
            "job",
            "join",
            "joy",
            "jump",
            "just",
            "keep",
            "kept",
            "key",
            "kill",
            "kind",
            "king",
            "knew",
            "know",
            "lady",
            "lake",
            "land",
            "language",
            "large",
            "last",
            "late",
            "laugh",
            "law",
            "lay",
            "lead",
            "learn",
            "least",
            "leave",
            "led",
            "left",
            "leg",
            "length",
            "less",
            "let",
            "letter",
            "level",
            "lie",
            "life",
            "lift",
            "light",
            "like",
            "line",
            "liquid",
            "list",
            "listen",
            "little",
            "live",
            "locate",
            "log",
            "lone",
            "long",
            "look",
            "lost",
            "lot",
            "loud",
            "love",
            "low",
            "machine",
            "made",
            "magnet",
            "main",
            "major",
            "make",
            "man",
            "many",
            "map",
            "mark",
            "market",
            "mass",
            "master",
            "match",
            "material",
            "matter",
            "may",
            "me",
            "mean",
            "meant",
            "measure",
            "meat",
            "meet",
            "melody",
            "men",
            "metal",
            "method",
            "middle",
            "might",
            "mile",
            "milk",
            "million",
            "mind",
            "mine",
            "minute",
            "miss",
            "mix",
            "modern",
            "molecule",
            "moment",
            "money",
            "month",
            "moon",
            "more",
            "morning",
            "most",
            "mother",
            "motion",
            "mount",
            "mountain",
            "mouth",
            "move",
            "much",
            "multiply",
            "music",
            "must",
            "my",
            "name",
            "nation",
            "natural",
            "nature",
            "near",
            "necessary",
            "neck",
            "need",
            "neighbor",
            "never",
            "new",
            "next",
            "night",
            "nine",
            "no",
            "noise",
            "noon",
            "nor",
            "north",
            "nose",
            "not",
            "note",
            "nothing",
            "notice",
            "noun",
            "now",
            "number",
            "numeral",
            "object",
            "observe",
            "occur",
            "ocean",
            "of",
            "off",
            "offer",
            "office",
            "often",
            "oh",
            "oil",
            "old",
            "on",
            "once",
            "one",
            "only",
            "open",
            "operate",
            "opposite",
            "or",
            "order",
            "organ",
            "original",
            "other",
            "our",
            "out",
            "over",
            "own",
            "oxygen",
            "page",
            "paint",
            "pair",
            "paper",
            "paragraph",
            "parent",
            "part",
            "particular",
            "party",
            "pass",
            "past",
            "path",
            "pattern",
            "pay",
            "people",
            "perhaps",
            "period",
            "person",
            "phrase",
            "pick",
            "picture",
            "piece",
            "pitch",
            "place",
            "plain",
            "plan",
            "plane",
            "planet",
            "plant",
            "play",
            "please",
            "plural",
            "poem",
            "point",
            "poor",
            "populate",
            "port",
            "pose",
            "position",
            "possible",
            "post",
            "pound",
            "power",
            "practice",
            "prepare",
            "present",
            "press",
            "pretty",
            "print",
            "probable",
            "problem",
            "process",
            "produce",
            "product",
            "proper",
            "property",
            "protect",
            "prove",
            "provide",
            "pull",
            "push",
            "put",
            "quart",
            "question",
            "quick",
            "quiet",
            "quite",
            "quotient",
            "race",
            "radio",
            "rail",
            "rain",
            "raise",
            "ran",
            "range",
            "rather",
            "reach",
            "read",
            "ready",
            "real",
            "reason",
            "receive",
            "record",
            "red",
            "region",
            "remember",
            "repeat",
            "reply",
            "represent",
            "require",
            "rest",
            "result",
            "rich",
            "ride",
            "right",
            "ring",
            "rise",
            "river",
            "road",
            "rock",
            "roll",
            "room",
            "root",
            "rope",
            "rose",
            "round",
            "row",
            "rub",
            "rule",
            "run",
            "safe",
            "said",
            "sail",
            "salt",
            "same",
            "sand",
            "sat",
            "save",
            "saw",
            "say",
            "scale",
            "school",
            "science",
            "score",
            "sea",
            "search",
            "season",
            "seat",
            "second",
            "section",
            "see",
            "seed",
            "seem",
            "segment",
            "select",
            "self",
            "sell",
            "send",
            "sense",
            "sent",
            "sentence",
            "separate",
            "serve",
            "set",
            "settle",
            "seven",
            "several",
            "shall",
            "shape",
            "share",
            "sharp",
            "she",
            "sheet",
            "shell",
            "shine",
            "ship",
            "shoe",
            "shop",
            "shore",
            "short",
            "should",
            "shoulder",
            "shout",
            "show",
            "side",
            "sight",
            "sign",
            "silent",
            "silver",
            "similar",
            "simple",
            "since",
            "sing",
            "single",
            "sister",
            "sit",
            "six",
            "size",
            "skill",
            "skin",
            "sky",
            "slave",
            "sleep",
            "slip",
            "slow",
            "small",
            "smell",
            "smile",
            "snow",
            "so",
            "soft",
            "soil",
            "soldier",
            "solution",
            "solve",
            "some",
            "son",
            "song",
            "soon",
            "sound",
            "south",
            "space",
            "speak",
            "special",
            "speech",
            "speed",
            "spell",
            "spend",
            "spoke",
            "spot",
            "spread",
            "spring",
            "square",
            "stand",
            "star",
            "start",
            "state",
            "station",
            "stay",
            "stead",
            "steam",
            "steel",
            "step",
            "stick",
            "still",
            "stone",
            "stood",
            "stop",
            "store",
            "story",
            "straight",
            "strange",
            "stream",
            "street",
            "stretch",
            "string",
            "strong",
            "student",
            "study",
            "subject",
            "substance",
            "subtract",
            "success",
            "such",
            "sudden",
            "suffix",
            "sugar",
            "suggest",
            "suit",
            "summer",
            "sun",
            "supply",
            "support",
            "sure",
            "surface",
            "surprise",
            "swim",
            "syllable",
            "symbol",
            "system",
            "table",
            "tail",
            "take",
            "talk",
            "tall",
            "teach",
            "team",
            "teeth",
            "tell",
            "temperature",
            "ten",
            "term",
            "test",
            "than",
            "thank",
            "that",
            "the",
            "their",
            "them",
            "then",
            "there",
            "these",
            "they",
            "thick",
            "thin",
            "thing",
            "think",
            "third",
            "this",
            "those",
            "though",
            "thought",
            "thousand",
            "three",
            "through",
            "throw",
            "thus",
            "tie",
            "time",
            "tiny",
            "tire",
            "to",
            "together",
            "told",
            "tone",
            "too",
            "took",
            "tool",
            "top",
            "total",
            "touch",
            "toward",
            "town",
            "track",
            "trade",
            "train",
            "travel",
            "tree",
            "triangle",
            "trip",
            "trouble",
            "truck",
            "true",
            "try",
            "tube",
            "turn",
            "twenty",
            "two",
            "type",
            "under",
            "unit",
            "until",
            "up",
            "us",
            "use",
            "usual",
            "valley",
            "value",
            "vary",
            "verb",
            "very",
            "view",
            "village",
            "visit",
            "voice",
            "vowel",
            "wait",
            "walk",
            "wall",
            "want",
            "war",
            "warm",
            "was",
            "wash",
            "watch",
            "water",
            "wave",
            "way",
            "we",
            "wear",
            "weather",
            "week",
            "weight",
            "well",
            "went",
            "were",
            "west",
            "what",
            "wheel",
            "when",
            "where",
            "whether",
            "which",
            "while",
            "white",
            "who",
            "whole",
            "whose",
            "why",
            "wide",
            "wife",
            "wild",
            "will",
            "win",
            "wind",
            "window",
            "wing",
            "winter",
            "wire",
            "wish",
            "with",
            "woman",
            "women",
            "won't",
            "wonder",
            "wood",
            "word",
            "work",
            "world",
            "would",
            "write",
            "written",
            "wrong",
            "wrote",
            "yard",
            "year",
            "yellow",
            "yes",
            "yet",
            "you",
            "young",
            "your",
        ]

    def check1000Words(self, text):
        text = text.lower()
        text = self.mh.stripPuncuation(text)
        text = text.split(" ")
        text = list(set(text))
        # If any of the top 1000 words in the text appear
        # return true
        if any self.top1000Words in text:
            return True
        return False

    def checkDictionary(self, text, language):
        """Compares a word with 
        The dictionary is sorted and the text is sorted"""
        # reads through most common words / passwords
        # and calculates how much of that is in language
        text = text.lower()
        text = self.mh.stripPuncuation(text)
        text = text.split(" ")
        text = list(set(text))  # removes duplicate words
        text.sort()
        # can dynamically use languages then
        language = str(language) + ".txt"

        # https://stackoverflow.com/questions/7165749/open-file-in-a-relative-location-in-python
        script_dir = os.path.dirname(__file__)
        file_path = os.path.join(script_dir, "English.txt")
        file = open(file_path, "r")
        f = file.readlines()
        file.close()
        f = [x.strip().lower() for x in f]
        # dictionary is "word\n" so I remove the "\n"

        # so this should loop until it gets to the point in the @staticmethod
        # that equals the word :)

        """
        for every single word in main dictionary
        if that word == text[0] then +1 to counter
        then +1 to text[0 + i]
        so say the dict is ordered
        we just loop through dict 
        and eventually we'll reach a point where word in dict = word in text
        at that point, we move to the next text point
        both text and dict are sorted
        so we only loop once, we can do this in O(n log n) time
        """
        counter = 0
        counter_percent = 0

        for dictLengthCounter, word in enumerate(f):
            # if there is more words counted than there is text
            # it is 100%, sometimes it goes over
            # so this stops that
            if counter >= len(text):
                break
            # if the dictionary word is contained in the text somewhere
            # counter + 1
            if word in text:
                counter = counter + 1
                counter_percent = counter_percent + 1
        self.languageWordsCounter = counter
        self.languagePercentage = self.mh.percentage(
            float(self.languageWordsCounter), float(len(text))
        )
        return counter

    def confirmlanguage(self, text, language):
        self.checkDictionary(text, language)
        if self.languagePercentage > self.languageThreshold:
            return True
        else:
            return False
